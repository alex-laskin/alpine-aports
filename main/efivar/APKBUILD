# Contributor: Carlo Landmeter <clandmeter@alpinelinux.org>
# Maintainer: Lucas Ramage <ramage.lucas@protonmail.com>
pkgname=efivar
pkgver=39
pkgrel=1
pkgdesc="Tools and library to manipulate EFI variables"
url="https://github.com/rhboot/efivar"
arch="all"
license="LGPL-2.1-only"
makedepends="popt-dev linux-headers mandoc"
subpackages="$pkgname-dev $pkgname-doc $pkgname-libs"
source="$pkgname-$pkgver.tar.gz::https://github.com/rhboot/efivar/archive/refs/tags/$pkgver.tar.gz
	no-march-native.patch
	"

build() {
	libdir="/usr/lib" make HOST_MARCH=
}

package() {
	libdir="/usr/lib" make DESTDIR="$pkgdir" install
}

check() {
	LD_LIBRARY_PATH="$builddir"/src \
		"$builddir"/src/efivar --help > /dev/null
}

sha512sums="
04493c30efbfc2773abac9a3dd93aa13403c05e29e3bfc72877d2054930811fae99119aadcb1729b6ca85abf5a24db786ea0c27c16d5458ef1b19e74696f5ff7  efivar-39.tar.gz
3aec177440c62ff237d807070dd80dd6df80532e99e77d4f817bd7db735def8a4e99201998d38d20d5e7c99734410eca60122d745b8cea710ecaf544715dd45a  no-march-native.patch
"
