# Maintainer: Celeste <cielesti@protonmail.com>
maintainer="Celeste <cielesti@protonmail.com>"
pkgname=astroterm
pkgver=1.0.9
pkgrel=0
pkgdesc="Terminal-based star map"
url="https://github.com/da-luce/astroterm"
arch="all"
license="MIT"
makedepends="
	argtable2-dev
	muon
	ncurses-dev
	xxd
	"
subpackages="$pkgname-doc"
source="https://github.com/da-luce/astroterm/archive/refs/tags/v$pkgver/astroterm-$pkgver.tar.gz
	$pkgname-bsc5-20231007::https://web.archive.org/web/20231007085824if_/http://tdc-www.harvard.edu/catalogs/BSC5
	"

prepare() {
	default_prepare

	ln -Tsvf ../../$pkgname-bsc5-20231007 data/bsc5
}

build() {
	abuild-muon \
		output .
	ninja -C output
}

check() {
	muon -C output test -j "${JOBS:-0}" -R -d dots
}

package() {
	DESTDIR="$pkgdir" muon -C output install

	install -Dvm644 README.md -t "$pkgdir"/usr/share/doc/$pkgname/
	install -Dvm644 LICENSE -t "$pkgdir"/usr/share/licenses/$pkgname/
}

sha512sums="
4524341e3216839e4f9100f6a2465681dd936598ec32e322ab23ba2ac5d9ed87f3db9f9ad0f370ca9604288286da79878b9a137c10630ef685e822a4e45391ac  astroterm-1.0.9.tar.gz
b96630ef38fa43bedff0462181b43276dca6c12d53ff91eb073d4985ec0fd191a6c84f8261cf6d4259f28ec80566765f53009fdca5508625ab8cb825c1e48e6a  astroterm-bsc5-20231007
"
