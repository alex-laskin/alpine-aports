# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=gtk-doc
pkgver=1.35.0
pkgrel=0
pkgdesc="Documentation tool for public library API"
url="https://gitlab.gnome.org/GNOME/gtk-doc"
arch="noarch"
license="GPL-2.0-or-later AND GFDL-1.1-or-later"
depends="docbook-xsl python3 pkgconf glib-dev py3-pygments"
makedepends="rarian-dev gettext autoconf automake libtool"
checkdepends="bc"
# https://discourse.gnome.org/t/new-way-of-releasing-gtk-doc/31754
#source="https://download.gnome.org/sources/gtk-doc/${pkgver%.*}/gtk-doc-$pkgver.tar.xz"
source="https://gitlab.gnome.org/GNOME/gtk-doc/-/archive/$pkgver/gtk-doc-$pkgver.tar.gz"

# it does not seem to be possible to disable tests of pdf which requires dblatex or fop
# disable checks for now
options="!check"

prepare() {
	default_prepare
	autoreconf -vif
}

build() {
	./configure \
		--build=$CBUILD \
		--host=$CHOST \
		--prefix=/usr \
		--with-highlight=highlight
	make
}

check() {
	make check
}

package() {
	make DESTDIR="$pkgdir" install
}

sha512sums="
30fa5ad0e5049bed6ff39f79864ccda46f53a113dde951739bfe804a2440deb5737e7561977f0cc6efeda2e8104ab1de2c5f1c025080a44ea1aed69feff75556  gtk-doc-1.35.0.tar.gz
"
