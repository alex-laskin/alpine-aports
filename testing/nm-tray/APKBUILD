# Contributor: cristian_ci <cristian_ci@protonmail.com>
# Maintainer: cristian_ci <cristian_ci@protonmail.com>
pkgname=nm-tray
pkgver=0.5.1
pkgrel=0
pkgdesc="Simple NetworkManager front end based on Qt"
url="https://github.com/palinek/nm-tray"
# armhf blocked by qt6-qtdeclarative
arch="all !armhf"
license="GPL-2.0-or-later"
makedepends="
	cmake
	networkmanager-qt-dev
	qt6-qtbase-dev
	qt6-qttools-dev
	samurai
	"
subpackages="$pkgname-lang"
source="$pkgname-$pkgver.tar.gz::https://github.com/palinek/nm-tray/archive/refs/tags/$pkgver.tar.gz"
options="!check" # no test suite

build() {
	cmake -B build -G Ninja \
		-DCMAKE_INSTALL_PREFIX=/usr \
		-DNM_TRAY_XDG_AUTOSTART_DIR=/etc/xdg/autostart
	cmake --build build
}

package() {
	DESTDIR="$pkgdir" cmake --install build
}

lang() {
	install_if="lang $pkgname=$pkgver-r$pkgrel"
	amove usr/share/$pkgname/*.qm
}

sha512sums="
5d280c90cdec68ed6c9b57f25db1558bf3b337d7b450fa53e9b2b393803ab6477e6659ec48152e6b9821c946240bc69b119633b02e4026d91278eb6be432eead  nm-tray-0.5.1.tar.gz
"
