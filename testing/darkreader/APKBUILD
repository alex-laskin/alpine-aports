maintainer="Hugo Osvaldo Barrera <hugo@whynothugo.nl>"
pkgname=darkreader
pkgver=4.9.110
pkgrel=0
pkgdesc="Dark Reader Firefox extension"
url="https://darkreader.org/"
# loongarch64: build produces no output file
# s390x, x86, ppc64le: no rollup binaries on npm
arch="noarch !x86 !s390x !loongarch64 !ppc64le"
license="MIT"
makedepends="git npm"
source="dark-reader-$pkgver.tar.gz::https://github.com/darkreader/darkreader/archive/refs/tags/v$pkgver.tar.gz"
options="net" # fetch dependencies

prepare() {
	default_prepare
	npm i
}

build() {
	npm run build
}

check() {
	npm test
}

package() {
	install -Dm644 build/release/darkreader-firefox.xpi "$pkgdir/usr/lib/firefox/browser/extensions/addon@darkreader.org.xpi"
}

sha512sums="
7797d1f0796bdffb1d208739358e2ba98f7e87c1514972e5e90ad6edff3e88bb7ef2953d0deea6997ceec5f68b5b58b0ca3df002453a94a38b4955c56c3bebb8  dark-reader-4.9.110.tar.gz
"
