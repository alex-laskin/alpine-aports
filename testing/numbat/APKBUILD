# Maintainer: Hoang Nguyen <folliekazetani@protonmail.com>
pkgname=numbat
pkgver=1.16.0
pkgrel=0
pkgdesc="Statically typed programming language for scientific computations"
url="https://numbat.dev/"
arch="all !s390x !riscv64" # nix crate fails to build
license="Apache-2.0"
makedepends="cargo cargo-auditable openssl-dev"
checkdepends="tzdata"
subpackages="$pkgname-doc"
source="$pkgname-$pkgver.tar.gz::https://github.com/sharkdp/numbat/archive/refs/tags/v$pkgver.tar.gz"

export OPENSSL_NO_VENDOR=1

prepare() {
	default_prepare

	cargo fetch --target="$CTARGET" --locked
}

build() {
	cargo auditable build --frozen --release
}

check() {
	cargo test --frozen
}

package() {
	install -Dm755 target/release/numbat -t "$pkgdir"/usr/bin/
	mkdir -p "$pkgdir"/usr/share/doc/$pkgname
	cp -r examples "$pkgdir"/usr/share/doc/$pkgname/
}

sha512sums="
a9b192947903f7ad64ba07873908eb7ae8e4e7dc29d4ceadd778e959a20de9dac1707555ecd8504c29be6e54a40c252712278070ed2a239b5d04eee9ca2a7786  numbat-1.16.0.tar.gz
"
