# Contributor: NeYurii <neyuriizkh@proton.me>
# Maintainer: NeYurii <neyuriizkh@proton.me>
pkgname=hypridle
pkgver=0.1.7
pkgrel=0
pkgdesc="Hyprland's idle daemon"
url="https://github.com/hyprwm/hypridle"
arch="all"
license="BSD-3-Clause"
makedepends="
	cmake
	samurai
	hyprwayland-scanner
	wayland-dev
	wayland-protocols
	hyprland-protocols
	hyprutils-dev
	hyprlang-dev
	sdbus-cpp-dev
"
options="!check" # currently there are no tests
subpackages="$pkgname-doc $pkgname-openrc"
source="
	$pkgname-$pkgver.tar.gz::https://github.com/hyprwm/hypridle/archive/refs/tags/v$pkgver.tar.gz
	hypridle.initd
"

build() {
	cmake -S . -B ./build -G Ninja \
		-DCMAKE_BUILD_TYPE:STRING=Release \
		-DCMAKE_INSTALL_LIBDIR=lib \
		-DCMAKE_INSTALL_PREFIX:PATH=/usr

	cmake --build ./build --config Release
}

package() {
	DESTDIR="$pkgdir" cmake --install build
	rm -r "$pkgdir"/usr/lib/systemd

	install -Dm755 "$srcdir"/hypridle.initd "$pkgdir"/etc/user/init.d/hypridle

	install -Dm0644 -t "$pkgdir"/usr/share/licenses/"$pkgname" LICENSE
}

sha512sums="
696201e17a1ce81e1fd687e1802032383ad3ea527e0eee83de57f9a4780b6a99b8de66079be7d9319effe88fe333995e6ba962538315bf9f15f65f6266a1ec32  hypridle-0.1.7.tar.gz
6a02ee33ff6465ec17f6004cc4dc07ac2fd92e63d23c43b40fff2d2ab99cc2cfa943035b9d0a442efb46bb65414da16f157a85dff4a1a1873d0b48ca18649375  hypridle.initd
"
