# Contributor: Joshua Murphy <joshuamurphy@posteo.net>
maintainer="Joshua Murphy <joshuamurphy@posteo.net>"
pkgname=hyperrogue
pkgver=13.1f
pkgrel=0
pkgdesc="SDL roguelike in a non-euclidean world"
url="https://roguetemple.com/z/hyper/"
arch="all"
license="GPL-2.0-or-later"
makedepends="
	glew-dev
	sdl2-dev
	sdl2_gfx-dev
	sdl2_mixer-dev
	sdl2_ttf-dev
	"
subpackages="$pkgname-doc"
source="$pkgname-$pkgver.tar.gz::https://github.com/zenorogue/hyperrogue/archive/v$pkgver.tar.gz"
options="!check" # no tests

build() {
	export HYPERROGUE_USE_GLEW=1
	export HYPERROGUE_USE_PNG=1
	make mymake
	./mymake -sdl2
}

package() {
	mkdir -p "$pkgdir"/usr/share/hyperrogue
	cp -a honeycombs/ "$pkgdir"/usr/share/hyperrogue/
	cp -a music/ "$pkgdir"/usr/share/hyperrogue/
	cp -a sounds/ "$pkgdir"/usr/share/hyperrogue/
	cp -a -- *.dat "$pkgdir"/usr/share/hyperrogue/
	cp -a -- *.ttf "$pkgdir"/usr/share/hyperrogue/

	mkdir -p "$pkgdir"/usr/share/doc/hyperrogue
	cp -a licenses/ "$pkgdir"/usr/share/doc/hyperrogue/

	install -Dm644 contrib/hyperrogue.desktop "$pkgdir"/usr/share/applications/hyperrogue.desktop
	install -Dm644 hyperrogue-music.txt "$pkgdir"/usr/share/hyperrogue/hyperrogue-music.txt
	install -Dm644 hyperroid/app/src/main/res/drawable-hdpi/icon.png "$pkgdir"/usr/share/pixmaps/hyperrogue.png
	install -Dm755 hyper "$pkgdir"/usr/bin/hyperrogue
	install -Dm644 officials.data "$pkgdir"/usr/share/hyperrogue/officials.data
	install -Dm644 papermodeldata.txt "$pkgdir"/usr/share/hyperrogue/papermodeldata.txt
	install -Dm644 papermodeldata-help.txt "$pkgdir"/usr/share/doc/hyperrogue/papermodeldata-help.txt
}

sha512sums="
46a95853ffdd00fff018a2494adc91cbdbe98097d0c698a2279e0964fb2df3315b1f6ad780cad2bedb7c78fc2c0c4e73ad78a2f9190cb824461dc9cc84a45090  hyperrogue-13.1f.tar.gz
"
