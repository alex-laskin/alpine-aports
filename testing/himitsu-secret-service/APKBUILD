maintainer="Hugo Osvaldo Barrera <hugo@whynothugo.nl>"
pkgname=himitsu-secret-service
pkgver=0.1_git20250705
_commit=38f1ae1898ca9583f2d1bdfdd43dea99fe0840d5
pkgrel=1
pkgdesc="Secret-service integration for Himitsu"
url="https://git.sr.ht/~apreiml/himitsu-secretservice"
arch="noarch"
license="MIT"
depends="py3-himitsu py3-cryptography py3-gobject3 py3-dbus"
makedepends="py3-hatchling py3-wheel py3-build py3-installer scdoc"
subpackages="$pkgname-pyc $pkgname-doc"
source="$pkgname-$pkgver.tar.gz::https://git.sr.ht/~apreiml/himitsu-secret-service/archive/$_commit.tar.gz"
provides="dbus:org.freedesktop.Secrets"
provider_priority=50
options="!check" # no tests
# builddir="$srcdir/$pkgname-$pkgver"
builddir="$srcdir/$pkgname-$_commit"

case "$CARCH" in
# Dependency not available on s390x.
s390x) ;;
*) depends="$depends py3-prctl" ;;
esac

prepare() {
	default_prepare
}

build() {
	python -m build --wheel --no-isolation
}

package() {
	make PREFIX=/usr DESTDIR="$pkgdir" install
}


sha512sums="
d8272768303d6bcd2b8d1c1209ef7314ae5e34b0945846cd30b64c6a17938f7a0923b8f4b0269c2c578939cb621089c975496bb5feee3e9d45528245c905e193  himitsu-secret-service-0.1_git20250705.tar.gz
"
