maintainer="Hugo Osvaldo Barrera <hugo@whynothugo.nl>"
pkgname=tofu-ls
pkgver=0.0.9
pkgrel=2
pkgdesc="OpenTofu language server"
url="https://github.com/opentofu/tofu-ls/"
# upstream doesn't support the others
arch="all !loongarch64 !ppc64le !riscv64 !s390x"
license="MPL-2.0"
makedepends="go"
subpackages="$pkgname-doc"
options="net"
source="$pkgname-$pkgver.tar.gz::https://github.com/opentofu/tofu-ls/archive/refs/tags/v$pkgver.tar.gz"

build() {
	go build -v
}

check() {
	go test -cover -covermode=atomic -timeout=5m ./...
}

package() {
	install -Dm755 tofu-ls -t "$pkgdir"/usr/bin/
	install -Dm644 docs/*.md -t "$pkgdir"/usr/share/doc/$pkgname/
	install -Dm644 LICENSE -t "$pkgdir"/usr/share/licenses/$pkgname/
}

sha512sums="
cb0203f70a78c8b8070cf2541ae22add99e3e36cdbe481b644fe73a5a3a963135525f0b1f316d082b17fa2296626209523327c572fdee1014865b4e9a23d18a6  tofu-ls-0.0.9.tar.gz
"
