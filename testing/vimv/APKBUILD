# Contributor: Ángel Castañeda <angel@acsq.me>
# Maintainer: qaqland <qaq@qaq.land>
pkgname=vimv
pkgver=3.1.0
pkgrel=0
pkgdesc="A command line utility for batch-renaming files"
url="https://www.dmulholl.com/dev/vimv.html"
arch="all"
license="0BSD"
makedepends="cargo cargo-auditable"
subpackages="$pkgname-doc"
source="$pkgname-$pkgver.tar.gz::https://github.com/dmulholl/vimv/archive/refs/tags/$pkgver.tar.gz
	bump-getrandom.patch
	"
options="net !check" # cargo fetch, upstream no test

prepare() {
	default_prepare

	cargo fetch --target="$CTARGET" --locked
}

build() {
	cargo auditable build --frozen --release
}

check() {
	cargo test --frozen --all-features
}

package() {
	install -Dm755 target/release/vimv -t "$pkgdir"/usr/bin/
	install -Dm644 license.txt -t "$pkgdir"/usr/share/licenses/$pkgname
}

sha512sums="
885127679f0f730dc5090d516b6bd85030717e3d568cf2ed42784fce7cd5a50c36ef32ca6b62a038fafd33a47fdc7ccd2ecd0049d964d70f05640fd058acb198  vimv-3.1.0.tar.gz
8e4bdebe54f76c0e6ac328af2c335267e999dddb72e26a75a518a8eca25cad968ce50ebcb7939567ae704d1f02512e19847e8671d79fbcd6f673bb32dbdeba12  bump-getrandom.patch
"
