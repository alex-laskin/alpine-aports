# Maintainer: Antoni Aloy <aaloytorrens@gmail.com>
pkgname=schismtracker
pkgver=20251014
pkgrel=0
pkgdesc="Oldschool sample-based music composition tool"
url="https://schismtracker.org/"
arch="all"
license="GPL-2.0-or-later"
depends="python3"
makedepends="
	alsa-lib-dev
	automake
	autoconf
	flac-dev
	libxext-dev
	libxv-dev
	python3-dev
	sdl2-compat-dev
	utf8proc-dev
	"
subpackages="$pkgname-doc"
source="https://github.com/schismtracker/schismtracker/releases/download/$pkgver/schismtracker-$pkgver.source.tar.gz"

build() {
	./configure \
		--build=$CBUILD \
		--host=$CHOST \
		--prefix=/usr \
		--enable-tests
	make
}

check() {
	make check
	./schismtrackertest
}

package() {
	make DESTDIR="$pkgdir" install

	# Remove test executable
	rm "$pkgdir"/usr/bin/schismtrackertest	
}

sha512sums="
ca91654c0a641488855972c56b424d3e8a53750683bc0fd707e6238fe980d2d2f733b9684c30ef2de17e878a46b1803ae7f086f2dbb2cb86220346ee17829c6b  schismtracker-20251014.source.tar.gz
"
