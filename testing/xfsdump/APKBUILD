# Contributor: Adam Thiede <me@adamthiede.com>
# Maintainer: Adam Thiede <me@adamthiede.com>
pkgname=xfsdump
pkgver=3.2.0
pkgrel=0
pkgdesc="xfs filesystem utilities"
url="https://mirrors.edge.kernel.org/pub/linux/utils/fs/xfs/xfsdump/"
arch="all"
license="GPL-2.0-only"
depends="xfsprogs"
makedepends="
	attr-dev
	bash
	intltool
	libtool
	libuuid
	linux-headers
	musl-libintl
	ncurses-dev
	util-linux-dev
	xfsprogs-dev
"
subpackages="$pkgname-doc"
source="
	https://mirrors.edge.kernel.org/pub/linux/utils/fs/xfs/xfsdump/xfsdump-$pkgver.tar.xz
	basename.patch
"
# patch from
# https://gitweb.gentoo.org/repo/gentoo.git/tree/sys-fs/xfsdump/files/xfsdump-3.1.12-mimic-basename-for-nonglibc.patch
options="!check" # no tests

build() {
	CFLAGS="$CFLAGS -D_LARGEFILE64_SOURCE"
	./configure --prefix=/usr
	make

}

package() {
	make DESTDIR="$pkgdir" install
}

sha512sums="
339317a92d7fda3e63b292db5e8a6d4a107a7f2ec269d54c109b6ade2f76cd823fb53db7a3a7e8a6c4883d6ce5626c7bc85fef6741f44699a4a8dfecfaa5231f  xfsdump-3.2.0.tar.xz
e7f3799d9ac55eaf173abcf47d92a4a19bcf4acd90b414dd5324863b9c58bd047702149a73bd911966313e9149f454de17cccd963003adc9cc1234ef6c7bd549  basename.patch
"
