# Contributor: Carlo Landmeter <clandmeter@alpinelinux.org>
maintainer="Carlo Landmeter <clandmeter@alpinelinux.org>"
pkgname=incus-ui-canonical
pkgver=0.18.0
pkgrel=0
pkgdesc="lxd-ui rebranded to incus"
url="https://github.com/zabbly/incus-ui-canonical"
arch="noarch !s390x !x86 !ppc64le !loongarch64 !riscv64" # FTBFS due to yarn
license="GPL-3.0-only"
makedepends="git yarn npm"
options="!check net"
source="$url/archive/refs/tags/incus-$pkgver.tar.gz"
builddir="$srcdir/$pkgname-incus-$pkgver"

prepare() {
	default_prepare
	yarn install --frozen-lockfile --ignore-scripts
}

build() {
	NODE_ENV=production yarn build
}

package() {
	mkdir -p "$pkgdir"/usr/share
	mv "$builddir"/build/ui "$pkgdir"/usr/share/incus-ui
}

sha512sums="
fb353e4459a8e9a49bd266c5a613bb4418705d8d7362311ba1d16a3fcd4df412b8899fab96229843a7d2da1dd8bdac8859ba287ff6e8ce9e1c301662b4281eba  incus-0.18.0.tar.gz
"
