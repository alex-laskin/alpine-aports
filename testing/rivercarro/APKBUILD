maintainer="Maarten van Gompel <proycon@anaproy.nl>"
pkgname=rivercarro
pkgver=0.6.0
_commit=793aa4cc890b96529ad3373dbe9d9d124b6f79f4
pkgrel=0
pkgdesc="A layout generator for river Wayland compositor, fork of rivertile"
url="https://git.sr.ht/~novakane/rivercarro"
arch="x86_64 aarch64" # limited by zig aport
license="GPL-3.0-only"
makedepends="
	libevdev-dev
	libxkbcommon-dev
	pixman-dev
	scdoc
	wayland-dev
	wayland-protocols
	wlroots-dev
	zig
	"
options="!check net"
subpackages="
	$pkgname-doc
"
source="
	$pkgname-$_commit.tar.gz::https://git.sr.ht/~novakane/rivercarro/archive/$_commit.tar.gz
	"
builddir="$srcdir/$pkgname-$_commit"

# We may want other than "baseline" for other targets, when enabled by zig
case "$CARCH" in
	aarch64|x86_64) _cputarget=baseline ;;
esac

build() {
	# This installs it to $builddir/out
	DESTDIR="$builddir/out" zig build \
		-Doptimize=ReleaseSafe \
		--prefix /usr install \
		${_cputarget:+-Dcpu="$_cputarget"}
}

package() {
	mkdir -p "$pkgdir"
	cp -r out/* "$pkgdir"
	install -Dm644 "doc/$pkgname.1" -t "$pkgdir/usr/share/man/man1"
}


sha512sums="
b0d9c807816d6a9c0d91f11ab6aee51b6717040a98fd82139b7fe6e3985be65743a5a2de410fcfb8120c983aa24334732bdee7c72bcbc340d02f72f0a2552f3e  rivercarro-793aa4cc890b96529ad3373dbe9d9d124b6f79f4.tar.gz
"
