# Contributor: Leon White <badfunkstripe@gmail.com>
# Maintainer: Leon White <badfunkstripe@gmail.com>
pkgname=bacon
pkgver=3.18.0
pkgrel=0
pkgdesc="Background code checker for Rust"
url="https://github.com/Canop/bacon"
arch="all"
license="AGPL-3.0-or-later"
makedepends="cargo cargo-auditable"
source="
	$pkgname-$pkgver.tar.gz::https://github.com/Canop/bacon/archive/v$pkgver.tar.gz
	rustix.patch
	"

prepare() {
	default_prepare

	cargo fetch --locked --target="$CTARGET"
}

build() {
	cargo auditable build --frozen --release
}

check() {
	cargo test --frozen --release
}

package() {
	install -Dm755 target/release/bacon -t "$pkgdir"/usr/bin/
}

sha512sums="
56db64ebc447a7e9aeb3f11bf463782fbe0e4327c32d24c1c6ff816ff7046ea1b80b3e86502d3a2b73d0d4bfb48447805dafd068185d56fe2e37c36489723cb6  bacon-3.18.0.tar.gz
9e71f19c2980a1003e1641ad5fe32b35a0eb87facb05ee8fc59f65307af7656c226b892b6f21799b4b33e3416721debad6f587a24bb33d557fab87978da9f407  rustix.patch
"
