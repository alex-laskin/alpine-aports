# Maintainer: Simon Rupf <simon@rupf.net>
pkgname=xpar
pkgver=0.7
pkgrel=0
pkgdesc="an error/erasure code system guarding data integrity"
url="https://github.com/iczelia/xpar"
# openmp is not available for armhf
arch="all !armhf"
license="LGPL-3.0-or-later"
makedepends="nasm openmp-dev"
subpackages="$pkgname-doc"
source="https://github.com/iczelia/xpar/releases/download/$pkgver/xpar-$pkgver.tar.gz"

build() {
	case "$CARCH" in
		aarch64|x86_64) _opts="--enable-$CARCH --enable-native" ;;
		*) _opts="" ;;
	esac

	./configure --prefix=/usr --enable-lto $_opts
	make all
}

check() {
	make check
}

package() {
	make DESTDIR="$pkgdir" install
}

sha512sums="
8a9d300cb11937977c67418c712c61b21536f173e892740fc10f87a02b7777cd7658722e7cb664d7e99037462049d9aa3d2c5594ce9d359c6664e44d8338bf2d  xpar-0.7.tar.gz
"
