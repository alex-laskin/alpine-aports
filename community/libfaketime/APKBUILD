# Contributor: Rasmus Thomsen <oss@cogitri.dev>
# Maintainer: mio <miyopan@e.email>
maintainer="mio <miyopan@e.email>"
pkgname=libfaketime
pkgver=0.9.12
pkgrel=0
pkgdesc="intercept system calls related to time and return user-defined values"
options="!check" # https://github.com/wolfcw/libfaketime/issues/259
url="https://github.com/wolfcw/libfaketime"
arch="all"
makedepends="coreutils"
license="GPL-2.0-or-later"
subpackages="$pkgname-doc"
source="$pkgname-$pkgver.tar.gz::https://github.com/wolfcw/libfaketime/archive/v$pkgver.tar.gz
	no-werror.patch
	time-t-32-bit.patch
	"

build() {
	make PREFIX=/usr
}

check() {
	make -j1 test
}

package() {
	make DESTDIR="$pkgdir" PREFIX="/usr" install
}

sha512sums="
c08325b2acd6a0ea3e3af5443f506714901c0be2be1acff5db9b9234b751f6cf653c69ae3ae86219ecb548e3c514adb8cc392af5cc9e2b354722f9d18bee4750  libfaketime-0.9.12.tar.gz
a5599eb03b4dd5461a3d070a46b14f1e1bf169a5d04ea19f2c169fd7cc903c84c9b17a66f0c195c090aadd376ea1cf68aa006d0717717697dcde06553558c206  no-werror.patch
bf5217b48da69b84e4566528d0f151e08f06798a424610afdf4d2d3578566b5fa67f9ae5b4f9f00e631a02839024fea7c78d3408a3d8359d59fd2c6e55352960  time-t-32-bit.patch
"
