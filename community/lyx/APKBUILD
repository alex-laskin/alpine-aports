# Contributor: Eloi Torrents <eloitor@disroot.org>
# Maintainer:
pkgname=lyx
pkgver=2.4.4
pkgrel=1
pkgdesc="Advanced WYSIWYM document processor & LaTeX front-end"
url="https://www.lyx.org"
arch="all"
license="GPL-2.0-or-later"
makedepends="
	boost-dev
	enchant2-dev
	file-dev
	mythes-dev
	qt6-qtbase-dev
	qt6-qtsvg-dev
	"
depends="
	imagemagick
	python3
	"
subpackages="$pkgname-doc $pkgname-lang $pkgname-pyc"
source="https://ftp.lip6.fr/pub/lyx/stable/${pkgver%.*}.x/lyx-$pkgver.tar.xz
	fix-memcpy-overlap.patch
	"

build() {
	./configure \
		--prefix=/usr \
		--sysconfdir=/etc \
		--enable-qt6 \
		--without-included-boost \
		--without-included-mythes \
		--disable-callstack-printing
	make
}

package() {
	make DESTDIR="$pkgdir" install
}

pyc() {
	default_pyc
	local IFS=$'\n'
	amove $(find usr/share/lyx -type d -name __pycache__)
}

sha512sums="
93c674aa71f017b62a5352468362fb0d48da0264a5308bb0228c4f8bf07a443004379a08ffe9fa1cc0393accc8fb9f95ae7a2b314c9c5b7b6023dba711688216  lyx-2.4.4.tar.xz
47f311b433739beb42e914e54491060f72836c08cab2bcaa4e465fcb20b5d4878eedb0a986266967f84b75d91986d7b14fa65706ec4efe4380b432ff6a89423d  fix-memcpy-overlap.patch
"
