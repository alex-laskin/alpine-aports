# Contributor: Leo <thinkabit.ukim@gmail.com>
# Maintainer: Celeste <cielesti@protonmail.com>
maintainer="Celeste <cielesti@protonmail.com>"
pkgname=sndio
pkgver=1.10.0
pkgrel=3
pkgdesc="Small audio and MIDI framework from the OpenBSD project"
url="https://sndio.org/"
arch="all"
license="ISC"
makedepends="alsa-lib-dev"
subpackages="$pkgname-dev $pkgname-doc $pkgname-libs $pkgname-openrc"
install="$pkgname.pre-install"
source="https://sndio.org/sndio-$pkgver.tar.gz
	sndiod.initd
	"
options="!check" # no tests provided

build() {
	./configure \
		--prefix=/usr \
		--enable-alsa \
		--privsep-user=sndiod
	make
}

package() {
	make DESTDIR="$pkgdir" install

	mkdir -p "$pkgdir"/usr/sbin
	mv -v "$pkgdir"/usr/bin/sndiod "$pkgdir"/usr/sbin/

	install -Dvm644 contrib/default.sndiod \
		"$pkgdir"/etc/conf.d/sndiod
	install -Dvm755 "$srcdir"/sndiod.initd \
		"$pkgdir"/etc/init.d/sndiod
}

sha512sums="
c35462976a1bffd128eacb185165964dac6b03505255e9ab9a933e24be5ed146cd9ac6995fd7af23247cb9133c010cce0876572db53b783ebabeb563fec7a1cf  sndio-1.10.0.tar.gz
593b3294c22fe3923b1771893e37d32295e1a47faefdb69a87f80590f862ebfcc9f94adceb6814f3b6fdca64b31253eb963201e2946d6f810f926eac997e6be1  sndiod.initd
"
