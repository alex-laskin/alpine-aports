# Contributor: Patrycja Rosa <alpine@ptrcnull.me>
# Maintainer: Patrycja Rosa <alpine@ptrcnull.me>
pkgname=osm-gps-map
pkgver=1.2.0
pkgrel=0
pkgdesc="Gtk+ Widget for Displaying OpenStreetMap tiles"
url="https://github.com/nzjrs/osm-gps-map"
arch="all"
license="GPL-2.0-or-later"
makedepends="
	autoconf
	autoconf-archive
	automake
	gobject-introspection-dev
	gtk+3.0-dev
	gtk-doc
	libsoup3-dev
	libtool
	"
checkdepends="xvfb-run python3 py3-cairo py3-gobject3"
subpackages="$pkgname-dev $pkgname-doc"
source="https://github.com/nzjrs/osm-gps-map/archive/$pkgver/osm-gps-map-$pkgver.tar.gz
	libsoup3.patch
	"
builddir="$srcdir/osm-gps-map-$pkgver"
options="!check" # tests not yet present in stable release

prepare() {
	default_prepare

	autoreconf -vfi
}

build() {
	./configure \
		--build=$CBUILD \
		--host=$CHOST \
		--prefix=/usr
	make
}

check() {
	python3 tests/test.py
}

package() {
	make DESTDIR="$pkgdir" install
}

sha512sums="
0b0527d316d87d925fbc8204e358a622e3bd8f65d4295b03d9e6db49f8f9086d324f5cdcb2be3cf2440bae73b72ff682f45f2e166bfb9f6b0b9ea822a7dba9db  osm-gps-map-1.2.0.tar.gz
c5601372cee1d1d4b0c80212cb7f257aa8995ba22002661bad6b85e3604c441cba96ffd8869cc63a9e52973714b4aa3caa8d6eee690864f04bbdbd18cb2f840a  libsoup3.patch
"
