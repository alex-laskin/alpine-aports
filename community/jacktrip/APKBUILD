maintainer="Hugo Osvaldo Barrera <hugo@whynothugo.nl>"
pkgname=jacktrip
pkgver=2.7.1
pkgrel=0
pkgdesc="Multi-machine audio network performance over the Internet"
url="https://jacktrip.github.io/jacktrip/"
# armhf, ppc64le, riscv64, s390x: qt6-qtwebengine
# x86, armv7: https://gitlab.alpinelinux.org/alpine/aports/-/issues/17428
# loongsoon: oscpp/endian.hpp needs to be set up for your CPU type
arch="all !armhf !ppc64le !riscv64 !s390x !x86 !armv7 !loongarch64"
license="MIT AND GPL-3.0-or-later AND LGPL-3.0-only"
makedepends="
	cmake
	help2man
	libsamplerate-dev
	meson
	py3-jinja2
	py3-yaml
	qt6-qt5compat-dev
	qt6-qtshadertools-dev
	qt6-qtsvg-dev
	qt6-qtwebengine-dev
	qt6-qtwebsockets-dev
	rtaudio-dev
"
subpackages="$pkgname-doc"
source="https://github.com/jacktrip/jacktrip/archive/v$pkgver/rtaudio-v$pkgver.tar.gz"

build() {
	abuild-meson -D noupdater=true . output
	meson compile -C output
}

check() {
	meson test -C output --print-errorlogs
}

package() {
	meson install -C output --destdir "$pkgdir"
	install -Dm644 LICENSE.md -t "$pkgdir/usr/share/licenses/$pkgname/"
	install -Dm644 LICENSES/MIT.txt -t "$pkgdir/usr/share/licenses/$pkgname/"
}

sha512sums="
4494811f2b5e52b49a17799da81496c90fefd4a23c680dd09e359e2e2e37a30d8c79d0db21a009e19fd4e4893ef8cc35408e36531b5e21a44e7bc0a89be77065  rtaudio-v2.7.1.tar.gz
"
