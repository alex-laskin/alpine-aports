# Maintainer: Celeste <cielesti@protonmail.com>
maintainer="Celeste <cielesti@protonmail.com>"
pkgname=opatch
pkgver=7.6f
pkgrel=0
pkgdesc="Portable OpenBSD patch(1)"
url="https://github.com/Projeto-Pindorama/opatch"
arch="all"
license="BSD-2-Clause"
makedepends="bsd-compat-headers"
subpackages="$pkgname-doc"
source="https://github.com/Projeto-Pindorama/opatch/releases/download/$pkgver/opatch-$pkgver.tar.xz
	redefinition.patch
	"

build() {
	make PROG=opatch
}

check() {
	mkdir -p testing
	cd testing
	cp -v ../baiacu.h .
	../opatch -Rfp1 -i ../../redefinition.patch
}

package() {
	install -Dvm755 opatch -t "$pkgdir"/usr/bin/
	install -Dvm644 patch.1 "$pkgdir"/usr/share/man/man1/opatch.1
}

sha512sums="
056340e4057fd82a11f67108323c7c54295515442d550122153a017bb563b461794d20d0ad82e75f1aff5ae988ed259c77187771ac8700472929726323a89cf1  opatch-7.6f.tar.xz
a5091f6318ba35203d0474dfee866300da461e787863228b3508157397f1065a6c49abc788bab6ba43bcdf8a190b6b8f3fff3ff53d4255a1abd77ff98d3521de  redefinition.patch
"
