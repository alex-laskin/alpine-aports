diff --git a/src/decl.h b/src/decl.h
index c19a6bc..866eb5f 100644
--- a/src/decl.h
+++ b/src/decl.h
@@ -217,4 +217,12 @@ typedef int mbstate_t;
 size_t mbrtowc (wchar_t * out, const char *s, int n, mbstate_t * st);
 #endif
 
+template<class T>
+T clamp(T v, T lo, T hi )
+{
+    if (v > hi) return hi;
+    if (v < lo) return lo;
+    return v;
+}
+
 #endif
diff --git a/src/screen.cc b/src/screen.cc
index eb18543..2d0dfb8 100644
--- a/src/screen.cc
+++ b/src/screen.cc
@@ -30,6 +30,8 @@
 #include "keyb.h"
 #include "configuration.h"
 
+#include <algorithm>
+
 static SDL_Surface *display = nullptr;
 static SDL_Window *sdlWindow = nullptr;
 static SDL_Renderer *sdlRenderer = nullptr;
@@ -1797,7 +1799,7 @@ static void putthings(long vert, long a, long angle) {
     /* calc the x pos where the thing has to be drawn */
     int x = sintab[a % TOWER_ANGLES] + (SCREENWID/2);
 
-    int depth = std::clamp(400-2*(sintab[(a+TOWER_ANGLES/4) % TOWER_ANGLES]+TOWER_RADIUS+SPR_STEPWID/2+1), 0, 205);
+    int depth = clamp(400-2*(sintab[(a+TOWER_ANGLES/4) % TOWER_ANGLES]+TOWER_RADIUS+SPR_STEPWID/2+1), 0, 205);
 
     int slice = 0;
     int ypos = SCREENHEI / 2 - SPR_SLICEHEI + vert;
@@ -1822,7 +1824,7 @@ static void putthings(long vert, long a, long angle) {
       /* ok calc the angle the robots needs to be drawn at */
       int rob_a = (rob_angle(rob) - 4 + angle) & (TOWER_ANGLES - 1);
 
-      int depth = std::clamp(400-2*(sintab[(rob_a+TOWER_ANGLES/4) % TOWER_ANGLES]+TOWER_RADIUS+SPR_STEPWID/2+1), 0, 205);
+      int depth = clamp(400-2*(sintab[(rob_a+TOWER_ANGLES/4) % TOWER_ANGLES]+TOWER_RADIUS+SPR_STEPWID/2+1), 0, 205);
 
       /* check if the robot is "inside" the current column */
       if (rob_a == a)
@@ -1897,7 +1899,7 @@ static void putthings_editor(long vert, long a, long angle, int state) {
     /* calc the x pos where the thing has to be drawn */
     int x = sintab[a % TOWER_ANGLES] + (SCREENWID/2);
 
-    int depth = std::clamp(400-2*(sintab[(a+TOWER_ANGLES/4) % TOWER_ANGLES]+TOWER_RADIUS+SPR_STEPWID/2+1), 0, 205);
+    int depth = clamp(400-2*(sintab[(a+TOWER_ANGLES/4) % TOWER_ANGLES]+TOWER_RADIUS+SPR_STEPWID/2+1), 0, 205);
 
     int slice = 0;
     int ypos = SCREENHEI / 2 - SPR_SLICEHEI + vert;
-- 
GitLab

