# Contributor: Francesco Colista <fcolista@alpinelinux.org>
# Maintainer: Francesco Colista <fcolista@alpinelinux.org>
pkgname=pg-gvm
pkgver=22.6.11
# PostgreSQL version
_pgver=17
pkgrel=0
pkgdesc="Greenbone Library for helper functions in PostgreSQL"
url="https://github.com/greenbone/pg-gvm"
arch="all"
license="GPL-3.0"
options="!check" # no check available
makedepends="cmake glib libical-dev gvm-libs-dev postgresql$_pgver-dev ninja"
source="$pkgname-$pkgver.tar.gz::https://github.com/greenbone/pg-gvm/archive/refs/tags/v$pkgver.tar.gz"

build() {
	cmake -B build -G Ninja \
		-DCMAKE_BUILD_TYPE=Release \
		-DCMAKE_INSTALL_PREFIX=/usr \
		-DPostgreSQL_INCLUDE_DIRS=/usr/include/postgresql/$_pgver/ \
		-DPostgreSQL_TYPE_INCLUDE_DIR=/usr/include/postgresql/$_pgver/
	cmake --build build
}

package() {
	DESTDIR="$pkgdir" cmake --install build
}

sha512sums="
2d47d28fd51455b61f908450f2789c7d6493cd1c53643d16cfe8bf5b98e792bba3f42de6c52428fa67b1aaa874646ee8bf6c14870b7a6713d381b78ad0edf3c9  pg-gvm-22.6.11.tar.gz
"
