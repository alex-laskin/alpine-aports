# Maintainer: mio <miyopan@e.email>
maintainer="mio <miyopan@e.email>"
pkgname=leocad
pkgver=25.09
_libver=25.08
pkgrel=0
pkgdesc="CAD application for creating virtual LEGO models"
url="https://www.leocad.org/"
license="GPL-2.0-or-later"
arch="all"
# Please check aarch64|arm* builds/runs without error before switching to qt6.
# 25.09 failed on arm with qt6-qtbase-6.9.1-r2:
# common/lc_context.cpp:15:10: fatal error: QOpenGLFunctions_3_2_Core:
# No such file or directory
makedepends="qt5-qtbase-dev qt5-qttools-dev zlib-dev"
subpackages="$pkgname-doc"
source="https://github.com/leozide/leocad/archive/v$pkgver/leocad-v$pkgver.tar.gz
	leocad-library-$_libver.zip::https://github.com/leozide/leocad/releases/download/v$pkgver/Library-$_libver.zip
	"
options="!check" # No tests

build() {
	DISABLE_UPDATE_CHECK=1 LDRAW_LIBRARY_PATH=/usr/share/leocad \
		qmake-qt5 leocad.pro
	make
}

package() {
	INSTALL_ROOT="$pkgdir" make install

	# Install parts library
	install -Dm644 "$srcdir"/library.bin -t "$pkgdir"/usr/share/leocad
}

sha512sums="
3b2d0698d46891cbc567729e88e129de53e27bd5754ecbfd754399f8bfa671eb3f9e9b879eb0a648576227f1c687afc4b635ef62adb970ad10ce16f810f95a59  leocad-v25.09.tar.gz
042881163baa9699bd9b78101c4ea5d270b6e72ac4d0a1325475a1eb6544631ef1e043e8f118a6107c135dd69861774c743c21bd49758b8a2cb394f4a070813b  leocad-library-25.08.zip
"
