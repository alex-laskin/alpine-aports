# Maintainer: Ariadne Conill <ariadne@dereferenced.org>
pkgname=tuxedo-yt6801
pkgver=1.0.30
_pkgver=${pkgver}tux4
_modname=yt6801
pkgrel=0
pkgdesc="third-party driver for YT6801 gigabit ethernet NICs"
url="https://gitlab.com/tuxedocomputers/development/packages/tuxedo-yt6801"
arch="all"
license="GPL-2.0-or-later"
depends="akms"
makedepends="rsync"
install="$pkgname.post-deinstall"
source="https://deb.tuxedocomputers.com/ubuntu/pool/main/t/tuxedo-yt6801/tuxedo-yt6801_${_pkgver}.tar.xz"
builddir="$srcdir/tuxedo-yt6801-${_pkgver}"
options="!check" # No tests available

package() {
	mkdir -p "$pkgdir"/usr/src/$_modname-$pkgver
	rsync --recursive --exclude=*.cmd --exclude=*.rules --exclude=*.d --exclude=*.ko --exclude=*.mod --exclude=*.mod.c --exclude=*.o --exclude=modules.order src/tuxedo-yt6801/src/ "$pkgdir"/usr/src/$_modname-$pkgver

	cat > "$pkgdir"/usr/src/$_modname-$pkgver/AKMBUILD <<-EOF
	modname=$_modname
	modver=$pkgver-r$pkgrel
	built_modules="yt6801.ko"
	EOF
}

sha512sums="
1de438dfbe82c93872d592bd6f0a6a894063e7f5fca5e4dac85324a978474a953fc65c28d52d74221027a7bff61efe7f09db09df8c7a4f4f560957be7c417255  tuxedo-yt6801_1.0.30tux4.tar.xz
"
