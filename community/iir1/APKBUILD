# Contributor: Milan P. Stanić <mps@arvanta.net>
# Maintainer: Milan P. Stanić <mps@arvanta.net>
pkgname=iir1
pkgver=1.10.0
pkgrel=0
pkgdesc="dsp iir realtime C++ filter library"
url="https://github.com/berndporr/iir1"
arch="all"
license="MIT"
makedepends="cmake samurai"
subpackages="$pkgname-dev $pkgname-doc"
source="$pkgname-$pkgver.tar.gz::https://github.com/berndporr/iir1/archive/refs/tags/$pkgver.tar.gz"
#builddir="$srcdir/"

build() {
	if [ "$CBUILD" != "$CHOST" ]; then
		CMAKE_CROSSOPTS="-DCMAKE_SYSTEM_NAME=Linux -DCMAKE_HOST_SYSTEM_NAME=Linux"
	fi
	cmake -B build -G Ninja \
		-DCMAKE_INSTALL_PREFIX=/usr \
		-DCMAKE_INSTALL_LIBDIR=lib \
		-DBUILD_SHARED_LIBS=True \
		-DCMAKE_BUILD_TYPE=MinSizeRel \
		$CMAKE_CROSSOPTS
	cmake --build build
}

check() {
	cd build
	ctest
}

package() {
	DESTDIR="$pkgdir" cmake --install build
	mkdir -p "$pkgdir"/usr/share/doc/$pkgname
	cp -r "$builddir"/docs "$pkgdir/usr/share/doc/$pkgname/manual"
}

sha512sums="
f50b925394f79662ae021c02e60667273a5d4615f2ef9f88d256c3c6dbb0f7d851207b65e2da56b69a97e576b3bb611653fde421df4ae0a952615d29be2f33a6  iir1-1.10.0.tar.gz
"
