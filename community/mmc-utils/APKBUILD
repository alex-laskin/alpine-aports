# Contributor: Olliver Schinagl <oliver@schinagl.nl>
# Maintainer: Olliver Schinagl <oliver@schinagl.nl>
# Contributor: Henrik Grimler <henrik@grimler.se>
pkgname=mmc-utils
pkgver=1.0
pkgrel=0
pkgdesc="Configure MMC storage devices from userspace"
url="https://www.kernel.org/doc/html/latest/driver-api/mmc/mmc-tools.html"
arch="all"
license="GPL-2.0-only"
makedepends="linux-headers"
options="!check" # No checks available
subpackages="$pkgname-doc"
source="https://git.kernel.org/pub/scm/utils/mmc/mmc-utils.git/snapshot/mmc-utils-$pkgver.tar.gz"

build() {
	# C=1 compiles with sparse, and compilation on aarch64 then
	# fails with a segmentation fault after lots of warnings like:
	#     /usr/include/stdio.h:14:5: warning: undefined preprocessor identifier '__STDC_VERSION__'
	#     /usr/include/bits/alltypes.h:5:5: warning: undefined preprocessor identifier '__AARCH64EB__'
	make C=0
}

package() {
	make DESTDIR="$pkgdir" prefix="/usr" install install-man
}

sha512sums="
f44d23f1befb9233a4ccbbefcaceb07028278af2f0c2059ce951ad2a685ef1cf13aac314d6565de191c8957c5d2a6c0a9e36486ff68e84eaa4b025412d6582ee  mmc-utils-1.0.tar.gz
"
