# Contributor: Erwan Rouchet <lucidiot@brainshit.fr>
# Maintainer: Erwan Rouchet <lucidiot@brainshit.fr>
pkgname=liferea
pkgver=1.16.5
pkgrel=0
pkgdesc="Desktop news aggregator for online news feeds and weblogs"
# armhf blocked by libpeas2
arch="all !armhf"
url="https://lzone.de/liferea"
license="GPL-2.0-or-later"
depends="py3-gobject3 libpeas2-python3"
makedepends="
	glib-dev
	intltool
	gobject-introspection-dev
	libxml2-dev
	libxslt-dev
	sqlite-dev
	gtk+3.0-dev
	pango-dev
	webkit2gtk-4.1-dev
	json-glib-dev
	gsettings-desktop-schemas-dev
	libpeas2-dev
	libsoup3-dev
	py3-gobject3-dev
	autoconf
	automake
	"
source="
	https://github.com/lwindolf/liferea/releases/download/v$pkgver/liferea-$pkgver.tar.bz2
	fix-typelib-dir.patch"
subpackages="$pkgname-doc $pkgname-lang"

prepare() {
	default_prepare
	autoreconf -i
	update_config_sub
}
	
build() {
	./configure \
		--build=$CBUILD \
		--host=$CHOST \
		--prefix=/usr \
		--sysconfdir=/etc \
		--localstatedir=/var \
		--disable-schemas-compile
	make
}

check() {
	make check
}

package() {
	make DESTDIR="$pkgdir" install
}

doc() {
	default_doc
	mkdir -p "$subpkgdir/usr/share/liferea"
	mv "$pkgdir/usr/share/liferea/doc" "$subpkgdir/usr/share/liferea/"
}

sha512sums="
2d8913098bea3cdfc005ce4bd25145ec054af6288c26cbe2f5832a8c57ecc3111530cddeb1c54fb2c659af24c8febff74ed30e1c317a6d3aeeb455ecaa55020d  liferea-1.16.5.tar.bz2
f19b49b7a1a3c7b92ea9e2ad86477fa85547b1de0f522a79704da7fdd634ad2ac41bfff02e67668c94646aa71bf49e376674e7658544bc3298fb66580a5fb6e6  fix-typelib-dir.patch
"
