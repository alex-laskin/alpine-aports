# Maintainer: Diaz Devera Victor <vitronic2@gmail.com>
pkgname=fcron
pkgver=3.4.0
pkgrel=1
pkgdesc="Periodical command scheduler for systems not always up"
url="http://fcron.free.fr/"
install="fcron.pre-install fcron.post-install fcron.post-upgrade"
options="suid !check"
pkgusers="fcron"
pkggroups="fcron"
arch="all"
license="GPL-2.0-or-later"
makedepends="readline-dev perl"
subpackages="$pkgname-openrc $pkgname-doc"
source="
	http://fcron.free.fr/archives/fcron-$pkgver.src.tar.gz
	systab.orig
	fcron.initd
	fcron.confd
	"

build() {
	./configure --prefix=/usr \
		--with-editor=/usr/bin/vi \
		--with-spooldir=/var/spool/fcron \
		--sysconfdir=/etc/fcron \
		--with-answer-all=no \
		--with-boot-install=no \
		--localstatedir=/var \
		--with-fifodir=/run \
		--with-piddir=/run \
		--with-sendmail=no \
		--with-selinux=no \
		--with-systemdsystemunitdir=no
	make
}

package() {
	make DESTDIR="$pkgdir/" install
	install -Dm755 "$srcdir"/fcron.initd "$pkgdir"/etc/init.d/fcron
	install -Dm644 "$srcdir"/fcron.confd "$pkgdir"/etc/conf.d/fcron
	#for some reason it man/fr is not compressed, for that reason I erase
	rm -r "$pkgdir"/usr/share/man/fr
	install -Dm640 "$srcdir/systab.orig" "$pkgdir/var/spool/fcron/systab.orig"
}

sha512sums="
1ce4cf2f72ac66bfc97ec28d8d3b8c53f44cff4307b80cda86419db6a1d9c3ed288d5ce92f4af8e497f775c975ee9e1b7d6cbb4ae07e84df4fe64fbdeb3a3558  fcron-3.4.0.src.tar.gz
e0abf7da0a9c1c2a8791f9f5b8cdb99260ac3bc49b0e4906ec3fb0d3344f8fe3819a7a80b1bc7b463fe4bc4499686e84ebb33aef9a0ec2298855b06340723e43  systab.orig
2cc205053537bbbb285f26a76458118ce8908b15f5df9b3655c5e530745d2e5cb41a443acdd77f2fc61bf855036236b29fe753a24041fc0d72bda6464cf414a0  fcron.initd
543f77d4613cd848369a4d2ac0f33c5b6991d5a02be2d2d16824b0020bec6d2816c162f3b3aa97530212ac450123eae2f6b2ce3af12c25887187845e9934b004  fcron.confd
"
