# Maintainer:
pkgname=airspyone-host
pkgver=1.0.10
pkgrel=2
pkgdesc="AirSpy's usemode driver and associated tools"
url="https://github.com/airspy/airspyone_host"
arch="all"
license="GPL-2.0-or-later"
depends_dev="$pkgname=$pkgver-r$pkgrel"
makedepends="
	cmake
	libusb-dev
	samurai
	"
subpackages="$pkgname-dev $pkgname-libs"
source="
	$pkgname-$pkgver.tar.gz::https://github.com/airspy/airspyone_host/archive/refs/tags/v$pkgver.tar.gz
	gcc-15.patch
	"
builddir="$srcdir/airspyone_host-$pkgver"
options="!check" # no tests

build() {
	CFLAGS="$CFLAGS -O2 -flto=auto -DNDEBUG" \
	CXXFLAGS="$CXXFLAGS -O2 -flto=auto -DNDEBUG" \
	cmake -B build -G Ninja \
		-DCMAKE_BUILD_TYPE=None \
		-DCMAKE_INSTALL_PREFIX=/usr \
		-DCMAKE_POLICY_VERSION_MINIMUM=3.5 \
		-DCMAKE_SKIP_INSTALL_RPATH=ON
	cmake --build build
}

package() {
	DESTDIR="$pkgdir" cmake --install build
}

sha512sums="
61ea82e8b9892053b6fdccd7de05f248145bb5da0d4f63bb31d3a815fa739b248662a875d53d88de260cfa2a98ef266ea165ba50397e67822ea21ca273c93b24  airspyone-host-1.0.10.tar.gz
15b7f8dd83831885dd422018f869f0c0f056625e8227484b1881182782e2845ae28fb8d2a2c360f342d1c155a286a3f937dfe84f9ee2a75a1be66937dd1b125e  gcc-15.patch
"
