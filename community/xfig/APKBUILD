# Contributor: Grigory Kirillov <txgk@bk.ru>
# Maintainer: mio <miyopan@e.email>
maintainer="mio <miyopan@e.email>"
pkgname=xfig
pkgver=3.2.9a
pkgrel=1
pkgdesc="Interactive drawing tool which runs under X Window System"
url="https://mcj.sourceforge.net/"
arch="all"
license="Xfig"
makedepends="
	libpng-dev
	libjpeg-turbo-dev
	tiff-dev
	libxaw-dev
	libxaw3d-dev
	libxft-dev
	ghostscript-dev
	sed
	"
subpackages="$pkgname-doc"
source="https://downloads.sourceforge.net/mcj/xfig-$pkgver.tar.xz
	gcc15-prototypes.patch
	gcc15-bool.patch
	COPYING
	"

build() {
	./configure \
		--target="$CTARGET" \
		--build="$CBUILD" \
		--host="$CHOST" \
		--prefix=/usr
	make
}

check() {
	# Muffle third test because it always fails.
	echo 'int main(void){return 0;}' > tests/test3.c

	make check
}

package() {
	make DESTDIR="$pkgdir" install
	install -Dm644 ../COPYING -t "$pkgdir"/usr/share/licenses/"$pkgname"/
}

sha512sums="
0a4cc4901cc8a56549c8145241011cb9e5d461a90975924897696d2b05f4a83c195f006c6b4b1270cf683883c967e0ace3a9f0b023a031d77e9492b41ee4f896  xfig-3.2.9a.tar.xz
b9d42759c711ac2b4cef144d80844a712eb22a84bb7e18aa359555ec02466e2e7cf586e594d300e7590a19ed699b58baddc2aedd9e765111bcb80af3ae33b5e5  gcc15-prototypes.patch
2ddd67ebd377ccc92807e0a12f23c9466892491762f9bbeba0b5d8ba44d636ca388ee52e2daa4c0d79d5af49bea3541f50f258e49725ebafee8059dda73ac282  gcc15-bool.patch
0289c266555028702e15749e557c7f17eaecc908f61458dbcfc118f547dbfb831351ec7cfce290368d343a7d7e9fa6914e81103312d94939938571f2acdc9424  COPYING
"
