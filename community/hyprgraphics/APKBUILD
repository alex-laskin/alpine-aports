maintainer="Zach DeCook <zachdecook@librem.one>"
pkgname=hyprgraphics
pkgver=0.1.5
pkgrel=0
pkgdesc="Hyprland graphics / resource utilities"
url="https://github.com/hyprwm/hyprgraphics"
arch="all"
license="BSD-3-Clause"
source="
	https://github.com/hyprwm/hyprgraphics/archive/v$pkgver/hyprgraphics-v$pkgver.tar.gz
	big-endian-jpeg.patch
	"
subpackages="$pkgname-doc $pkgname-dev"
makedepends="
	cairo-dev
	cmake
	file-dev
	hyprutils-dev
	libjpeg-turbo-dev
	libspng-dev
	libwebp-dev
	samurai
	pixman-dev
	"

# libjxl not available on s390x, so compile without JXL support
if ! test "$CARCH" = "s390x"; then
	makedepends="$makedepends libjxl-dev"
fi

build() {
	cmake -B build -G Ninja \
		-DCMAKE_INSTALL_PREFIX=/usr \
		-DCMAKE_INSTALL_LIBDIR=lib \
		-DCMAKE_BUILD_TYPE=None
	cmake --build build
}

check() {
	cd build
	ctest
}

package() {
	DESTDIR="$pkgdir" cmake --install build
	install -Dm644 LICENSE "$pkgdir"/usr/share/licenses/$pkgname/LICENSE
}


sha512sums="
592b36a4eefd1a6f3f0f381d3038d095d8d8344685a34f319bdd743b40c2913f1e654bc0c97f21821dc41b4c97041045f364fabe9bcd608048bd629cdcb4e515  hyprgraphics-v0.1.5.tar.gz
e03b6ccde020a02d4a32c7a524837c30cf54455b30ab5cf156110c0c6dfebda560a8060af5c4c3e2491f1a1ec333169c4cf6c5bc3db68540a40d1574a86ed18d  big-endian-jpeg.patch
"
