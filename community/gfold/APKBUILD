maintainer="Michał Polański <michal@polanski.me>"
pkgname=gfold
pkgver=2025.9.0
pkgrel=0
pkgdesc="CLI tool to help keep track of Git repositories"
url="https://github.com/nickgerace/gfold"
license="Apache-2.0"
arch="all"
makedepends="cargo cargo-auditable"
options="net"
source="https://github.com/nickgerace/gfold/archive/$pkgver/gfold-$pkgver.tar.gz
	loongarch64-downgrade-libc.patch
	"

prepare() {
	default_prepare

	cargo fetch --target="$CTARGET" --locked
}

build() {
	cargo auditable build --release --frozen
}

check() {
	git init # needed for the integration test
	cargo test --frozen --workspace
}

package() {
	install -Dm755 target/release/$pkgname -t "$pkgdir"/usr/bin/
}

sha512sums="
f62dbb696f79a53fe7c1b3381abd18bf04cc97cb1889877c3ffaac299e9f1a730a979797b227243bd03869a0fe7caad3c5db248bd520e9e4e509a816ad58b8e7  gfold-2025.9.0.tar.gz
c799f9a829744dc4aec051892f64f65f269974d9add238a131774d377ec00d603dc9540a3d99031396cb11e88d9157004c14477beddebe8d5ad25b9ae8c28475  loongarch64-downgrade-libc.patch
"
