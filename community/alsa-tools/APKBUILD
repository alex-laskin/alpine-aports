# Contributor: Rasmus Thomsen <oss@cogitri.dev>
# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=alsa-tools
pkgver=1.2.14
pkgrel=0
pkgdesc="Advanced tools for certain sound cards"
url="https://alsa-project.org/"
arch="all"
license="GPL-2.0-or-later"
makedepends="fltk-dev gtk+2.0-dev gtk+3.0-dev alsa-lib-dev bash autoconf automake
	libtool"
options="!check" # No tests
subpackages="$pkgname-dev $pkgname-doc $pkgname-gui:_gui"
source="https://alsa-project.org/files/pub/tools/alsa-tools-$pkgver.tar.bz2"

prepare() {
	default_prepare

	# Remove qlo10k1 package, only works with Qt2/Qt3
	sed 's/qlo10k1//' -i Makefile
}

build() {
	make configure CONFIGURE_ARGS="--prefix=/usr"
}

package() {
	make DESTDIR="$pkgdir" install

	cp -r "$pkgdir"/usr/local/* "$pkgdir"/usr/
	rm -r "$pkgdir"/usr/local
}

_gui() {
	pkgdesc="$pkgdesc (GUI tools)"

	mkdir -p "$subpkgdir"/usr/bin
	mv "$pkgdir"/usr/bin/echomixer "$subpkgdir"/usr/bin
	mv "$pkgdir"/usr/bin/envy24control "$subpkgdir"/usr/bin
	mv "$pkgdir"/usr/bin/hdajackretask "$subpkgdir"/usr/bin
	mv "$pkgdir"/usr/bin/hdspconf "$subpkgdir"/usr/bin
	mv "$pkgdir"/usr/bin/hdspmixer "$subpkgdir"/usr/bin
	mv "$pkgdir"/usr/bin/rmedigicontrol "$subpkgdir"/usr/bin
}

sha512sums="
36996eb19c590f3f8deb5831ef4e4a9016578e42172901dd97ebe78a4c6fc14e8d84d8f6639cc37d2db91c1d73727226cf1a5d952c586cfc909768377b04e8c7  alsa-tools-1.2.14.tar.bz2
"
