Patch-Source: https://github.com/h5py/h5py/pull/2556
---
From 2552f11a377838c2bd9689ede4094ac09b3905fc Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Cl=C3=A9ment=20Robert?= <cr52@protonmail.com>
Date: Mon, 10 Feb 2025 09:00:38 +0100
Subject: [PATCH] BLD: fix build-time compatibility with numpy 2.3

---
 h5py/_conv.pyx | 4 ++--
 h5py/utils.pyx | 7 +++++--
 2 files changed, 7 insertions(+), 4 deletions(-)

diff --git a/h5py/_conv.pyx b/h5py/_conv.pyx
index 6e0fea571..e895829eb 100644
--- a/h5py/_conv.pyx
+++ b/h5py/_conv.pyx
@@ -27,7 +27,7 @@ cfg = get_config()
 
 # Initialization of numpy
 cimport numpy as cnp
-from numpy cimport npy_intp, NPY_WRITEABLE, NPY_C_CONTIGUOUS, NPY_OWNDATA, PyArray_DATA
+from numpy cimport npy_intp, NPY_ARRAY_WRITEABLE, NPY_ARRAY_C_CONTIGUOUS, NPY_ARRAY_OWNDATA, PyArray_DATA
 cnp._import_array()
 import numpy as np
 
@@ -695,7 +695,7 @@ cdef int conv_vlen2ndarray(void* ipt,
     cdef:
         PyObject** buf_obj = <PyObject**>opt
         vlen_t* in_vlen = <vlen_t*>ipt
-        int flags = NPY_WRITEABLE | NPY_C_CONTIGUOUS | NPY_OWNDATA
+        int flags = NPY_ARRAY_WRITEABLE | NPY_ARRAY_C_CONTIGUOUS | NPY_ARRAY_OWNDATA
         npy_intp dims[1]
         void* data
         char[:] buf
diff --git a/h5py/utils.pyx b/h5py/utils.pyx
index 47105ee3c..92da550d4 100644
--- a/h5py/utils.pyx
+++ b/h5py/utils.pyx
@@ -13,7 +13,7 @@
 from numpy cimport ndarray, import_array,\
                    NPY_UINT16, NPY_UINT32, NPY_UINT64,  npy_intp,\
                    PyArray_SimpleNew, PyArray_FROM_OTF,\
-                   NPY_CONTIGUOUS, NPY_NOTSWAPPED, NPY_FORCECAST
+                   NPY_ARRAY_C_CONTIGUOUS, NPY_ARRAY_NOTSWAPPED, NPY_ARRAY_FORCECAST
 
 # Initialization
 import_array()
@@ -164,7 +164,10 @@ cdef object create_hsize_array(object arr):
     else:
         raise RuntimeError("Can't map hsize_t %d to Numpy typecode" % sizeof(hsize_t))
 
-    return PyArray_FROM_OTF(arr, typecode, NPY_CONTIGUOUS | NPY_NOTSWAPPED | NPY_FORCECAST)
+    return PyArray_FROM_OTF(arr, typecode,
+        NPY_ARRAY_C_CONTIGUOUS
+        | NPY_ARRAY_NOTSWAPPED
+        | NPY_ARRAY_FORCECAST)
 
 
 # === Argument testing ========================================================
