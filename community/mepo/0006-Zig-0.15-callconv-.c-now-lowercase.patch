From c7cc7afae00e96eab8df14aabdd28f4180113b36 Mon Sep 17 00:00:00 2001
From: LN Liberda <lauren@selfisekai.rocks>
Date: Thu, 21 Aug 2025 02:50:06 +0200
Subject: [PATCH] Zig 0.15: callconv(.c), now lowercase

---
 src/Mepo.zig                | 4 ++--
 src/TileCache.zig           | 8 ++++----
 src/api/shellpipe_async.zig | 2 +-
 src/api/shellpipe_sync.zig  | 2 +-
 src/util/utilsdl.zig        | 2 +-
 5 files changed, 9 insertions(+), 9 deletions(-)

diff --git a/src/Mepo.zig b/src/Mepo.zig
index e9124b9..e8ae0ad 100644
--- a/src/Mepo.zig
+++ b/src/Mepo.zig
@@ -493,7 +493,7 @@ pub fn init_video_and_sdl_stdin_loop(mepo: *Self, enable_stdin_jsonapi_repl: boo
     }
 }
 
-fn mepo_sdl_loop_thread_boot(userdata: ?*anyopaque) callconv(.C) c_int {
+fn mepo_sdl_loop_thread_boot(userdata: ?*anyopaque) callconv(.c) c_int {
     const mepo: *Self = @alignCast(@ptrCast(userdata.?));
     video_init(mepo) catch unreachable;
     mepo.jsonapi_execute(mepo.config_contents) catch unreachable;
@@ -634,7 +634,7 @@ pub fn graceful_terminate_sdl() void {
     std.posix.exit(0);
 }
 
-pub fn sighandle_terminate(arg: c_int) callconv(.C) void {
+pub fn sighandle_terminate(arg: c_int) callconv(.c) void {
     utildbg.log("Graceful shutdown via signal: {}", .{arg});
     graceful_terminate_sdl();
 }
diff --git a/src/TileCache.zig b/src/TileCache.zig
index 1b5552e..add1e4e 100644
--- a/src/TileCache.zig
+++ b/src/TileCache.zig
@@ -339,7 +339,7 @@ fn curl_callback_tile_xferinfo(
     dl_now: curl.curl_off_t,
     ul_total: curl.curl_off_t,
     ul_now: curl.curl_off_t,
-) callconv(.C) c_uint {
+) callconv(.c) c_uint {
     //utildbg.log("Progress: {} {}\n", .{ dl_now, dl_total });
     _ = ul_total;
     _ = ul_now;
@@ -354,7 +354,7 @@ fn curl_callback_tile_write(
     size: c_uint,
     nmemb: c_uint,
     user_data: *anyopaque,
-) callconv(.C) c_uint {
+) callconv(.c) c_uint {
     //utildbg.log("Write!!: \n", .{});
     const transfer_datum: *TransferDatum = @alignCast(@ptrCast(user_data));
     const typed_data: [*]u8 = @ptrCast(data);
@@ -503,7 +503,7 @@ fn tile_exists_in_fs_and_non_expired(tile_cache: *Self, coords: types.XYZ) !bool
     return false;
 }
 
-fn threadable_tile_bg_bbox_queue(userdata: ?*anyopaque) callconv(.C) c_int {
+fn threadable_tile_bg_bbox_queue(userdata: ?*anyopaque) callconv(.c) c_int {
     const tile_cache: *Self = @alignCast(@ptrCast(userdata.?));
     if (tile_cache.tile_bg_bbox_queue(tile_cache.bbox_queue.?, true)) |q| {
         utildbg.log("Done: {}\n", .{q});
@@ -514,7 +514,7 @@ fn threadable_tile_bg_bbox_queue(userdata: ?*anyopaque) callconv(.C) c_int {
     return 0;
 }
 
-fn threadable_download_loop_sdl(userdata: ?*anyopaque) callconv(.C) c_int {
+fn threadable_download_loop_sdl(userdata: ?*anyopaque) callconv(.c) c_int {
     const tile_cache: *Self = @alignCast(@ptrCast(userdata.?));
     tile_cache.download_loop(true) catch |e| {
         utildbg.log("Error running download loop: {}\n", .{e});
diff --git a/src/api/shellpipe_async.zig b/src/api/shellpipe_async.zig
index 4599545..b6a71c7 100644
--- a/src/api/shellpipe_async.zig
+++ b/src/api/shellpipe_async.zig
@@ -37,7 +37,7 @@ fn async_shellpipe(mepo: *Mepo, unique_handle_id: i8, cmd: []const u8) !void {
     sdl.SDL_DetachThread(sdl.SDL_CreateThread(async_shellpipe_run, "async_shellpipe", sp_req));
 }
 
-fn async_shellpipe_run(userdata: ?*anyopaque) callconv(.C) c_int {
+fn async_shellpipe_run(userdata: ?*anyopaque) callconv(.c) c_int {
     const shellpipe_request: *AsyncShellpipeRequest = @alignCast(@ptrCast(userdata.?));
     const mepo = shellpipe_request.mepo;
     defer mepo.allocator.destroy(shellpipe_request);
diff --git a/src/api/shellpipe_sync.zig b/src/api/shellpipe_sync.zig
index c2706b3..b260e60 100644
--- a/src/api/shellpipe_sync.zig
+++ b/src/api/shellpipe_sync.zig
@@ -36,7 +36,7 @@ const Request = struct {
     cmd: []const u8,
 };
 
-fn run_sync_shellpipe(userdata: ?*anyopaque) callconv(.C) c_int {
+fn run_sync_shellpipe(userdata: ?*anyopaque) callconv(.c) c_int {
     const request: *Request = @alignCast(@ptrCast(userdata.?));
     defer request.mepo.allocator.destroy(request);
     run_shellpipe(request.mepo, null, request.cmd) catch |err|
diff --git a/src/util/utilsdl.zig b/src/util/utilsdl.zig
index 6ccf640..d9a7428 100644
--- a/src/util/utilsdl.zig
+++ b/src/util/utilsdl.zig
@@ -44,7 +44,7 @@ pub fn sdl_push_event_jsonapi_execution(jsonapi_text: [:0]const u8) void {
     };
 }
 
-pub fn sdl_push_event_signal(signal: c_int) callconv(.C) void {
+pub fn sdl_push_event_signal(signal: c_int) callconv(.c) void {
     var sdlevent: sdl.SDL_Event = undefined;
     sdlevent.type = sdl_usereventtype(.Signal);
     sdlevent.user.code = signal;
