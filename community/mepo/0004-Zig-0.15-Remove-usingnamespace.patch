From a4eb6ca008f9107f867f78e8253c0e6a0b063c4a Mon Sep 17 00:00:00 2001
From: LN Liberda <lauren@selfisekai.rocks>
Date: Thu, 21 Aug 2025 02:41:59 +0200
Subject: [PATCH] Zig 0.15: Remove usingnamespace

---
 src/Mepo.zig                | 18 +++++++++++++-----
 src/TileCache.zig           |  2 +-
 src/api/bind_button.zig     |  2 +-
 src/api/bind_click.zig      |  2 +-
 src/api/bind_gesture.zig    |  2 +-
 src/api/bind_key.zig        |  2 +-
 src/api/bind_quit.zig       |  2 +-
 src/api/bind_signal.zig     |  2 +-
 src/api/bind_timer.zig      |  2 +-
 src/api/center_on_mouse.zig |  2 +-
 src/api/clipcopy.zig        |  2 +-
 src/api/clippaste.zig       |  2 +-
 src/api/filedump.zig        |  2 +-
 src/api/shellpipe_async.zig |  2 +-
 src/api/shellpipe_sync.zig  |  2 +-
 src/blit/blit.zig           |  2 +-
 src/main.zig                |  2 +-
 src/sdlshim.zig             |  7 -------
 src/types.zig               |  8 +++++++-
 src/util/utilplatform.zig   |  2 +-
 src/util/utilsdl.zig        |  2 +-
 21 files changed, 38 insertions(+), 31 deletions(-)
 delete mode 100644 src/sdlshim.zig

diff --git a/src/Mepo.zig b/src/Mepo.zig
index c2d017c..258674d 100644
--- a/src/Mepo.zig
+++ b/src/Mepo.zig
@@ -1,6 +1,6 @@
 const std = @import("std");
-const sdl = @import("./sdlshim.zig");
 const types = @import("./types.zig");
+const sdl = types.sdl;
 const config = @import("./config.zig");
 const errors = @import("./errors.zig");
 const TileCache = @import("./TileCache.zig");
@@ -102,13 +102,21 @@ fn event_multigesture(mepo: *Self, e: sdl.SDL_Event) types.Pending {
     const threshold_pan_dist = 0.004;
     const threshold_rotate_radians = 0.015;
     const run_gesture: types.GestureInput = if (e.mgesture.dDist > threshold_pan_dist) .{
-        .action = .Pan, .direction = .In, .n_fingers = @intCast(e.mgesture.numFingers),
+        .action = .Pan,
+        .direction = .In,
+        .n_fingers = @intCast(e.mgesture.numFingers),
     } else if (e.mgesture.dDist < -threshold_pan_dist) .{
-        .action = .Pan, .direction = .Out, .n_fingers = @intCast(e.mgesture.numFingers),
+        .action = .Pan,
+        .direction = .Out,
+        .n_fingers = @intCast(e.mgesture.numFingers),
     } else if (e.mgesture.dTheta > threshold_rotate_radians) .{
-        .action = .Rotate, .direction = .In, .n_fingers = @intCast(e.mgesture.numFingers),
+        .action = .Rotate,
+        .direction = .In,
+        .n_fingers = @intCast(e.mgesture.numFingers),
     } else if (e.mgesture.dTheta < -threshold_rotate_radians) .{
-        .action = .Rotate, .direction = .Out, .n_fingers = @intCast(e.mgesture.numFingers),
+        .action = .Rotate,
+        .direction = .Out,
+        .n_fingers = @intCast(e.mgesture.numFingers),
     } else return .None;
 
     mepo.fingers_gesture_delta += if (run_gesture.direction == .In) 1 else -1;
diff --git a/src/TileCache.zig b/src/TileCache.zig
index 3bb969e..1b5552e 100644
--- a/src/TileCache.zig
+++ b/src/TileCache.zig
@@ -5,8 +5,8 @@ const curl = @cImport({
 const cstdio = @cImport({
     @cInclude("stdio.h");
 });
-const sdl = @import("./sdlshim.zig");
 const types = @import("./types.zig");
+const sdl = types.sdl;
 const config = @import("./config.zig");
 const utilsdl = @import("./util/utilsdl.zig");
 const utilconversion = @import("./util/utilconversion.zig");
diff --git a/src/api/bind_button.zig b/src/api/bind_button.zig
index 0006cc5..eff94bc 100644
--- a/src/api/bind_button.zig
+++ b/src/api/bind_button.zig
@@ -1,7 +1,7 @@
 const Mepo = @import("../Mepo.zig");
 const types = @import("../types.zig");
 const std = @import("std");
-const sdl = @import("../sdlshim.zig");
+const sdl = types.sdl;
 const utildbg = @import("../util/utildbg.zig");
 
 pub const spec = types.MepoFnSpec{
diff --git a/src/api/bind_click.zig b/src/api/bind_click.zig
index 54e66cf..8231170 100644
--- a/src/api/bind_click.zig
+++ b/src/api/bind_click.zig
@@ -1,7 +1,7 @@
 const Mepo = @import("../Mepo.zig");
 const types = @import("../types.zig");
 const std = @import("std");
-const sdl = @import("../sdlshim.zig");
+const sdl = types.sdl;
 const utildbg = @import("../util/utildbg.zig");
 
 pub const spec = types.MepoFnSpec{
diff --git a/src/api/bind_gesture.zig b/src/api/bind_gesture.zig
index e808b69..0ebac77 100644
--- a/src/api/bind_gesture.zig
+++ b/src/api/bind_gesture.zig
@@ -1,7 +1,7 @@
 const Mepo = @import("../Mepo.zig");
 const types = @import("../types.zig");
 const std = @import("std");
-const sdl = @import("../sdlshim.zig");
+const sdl = types.sdl;
 const utildbg = @import("../util/utildbg.zig");
 
 pub const spec = types.MepoFnSpec{
diff --git a/src/api/bind_key.zig b/src/api/bind_key.zig
index 2b36816..36012ba 100644
--- a/src/api/bind_key.zig
+++ b/src/api/bind_key.zig
@@ -1,7 +1,7 @@
 const Mepo = @import("../Mepo.zig");
 const types = @import("../types.zig");
 const std = @import("std");
-const sdl = @import("../sdlshim.zig");
+const sdl = types.sdl;
 const utildbg = @import("../util/utildbg.zig");
 
 pub const spec = types.MepoFnSpec{
diff --git a/src/api/bind_quit.zig b/src/api/bind_quit.zig
index c8eafce..0fd9072 100644
--- a/src/api/bind_quit.zig
+++ b/src/api/bind_quit.zig
@@ -1,7 +1,7 @@
 const Mepo = @import("../Mepo.zig");
 const types = @import("../types.zig");
 const std = @import("std");
-const sdl = @import("../sdlshim.zig");
+const sdl = types.sdl;
 const utildbg = @import("../util/utildbg.zig");
 
 pub const spec = types.MepoFnSpec{
diff --git a/src/api/bind_signal.zig b/src/api/bind_signal.zig
index 533f499..67c1dbc 100644
--- a/src/api/bind_signal.zig
+++ b/src/api/bind_signal.zig
@@ -1,7 +1,7 @@
 const Mepo = @import("../Mepo.zig");
 const types = @import("../types.zig");
 const std = @import("std");
-const sdl = @import("../sdlshim.zig");
+const sdl = types.sdl;
 const utildbg = @import("../util/utildbg.zig");
 const utilsdl = @import("../util/utilsdl.zig");
 
diff --git a/src/api/bind_timer.zig b/src/api/bind_timer.zig
index c6e10c4..16f99fc 100644
--- a/src/api/bind_timer.zig
+++ b/src/api/bind_timer.zig
@@ -1,7 +1,7 @@
 const Mepo = @import("../Mepo.zig");
 const types = @import("../types.zig");
 const std = @import("std");
-const sdl = @import("../sdlshim.zig");
+const sdl = types.sdl;
 const utildbg = @import("../util/utildbg.zig");
 const utilsdl = @import("../util/utilsdl.zig");
 
diff --git a/src/api/center_on_mouse.zig b/src/api/center_on_mouse.zig
index a0161b2..154eb7b 100644
--- a/src/api/center_on_mouse.zig
+++ b/src/api/center_on_mouse.zig
@@ -1,7 +1,7 @@
 const Mepo = @import("../Mepo.zig");
 const types = @import("../types.zig");
 const std = @import("std");
-const sdl = @import("../sdlshim.zig");
+const sdl = types.sdl;
 const p = @import("../util/utilprefs.zig");
 
 pub const spec = types.MepoFnSpec{
diff --git a/src/api/clipcopy.zig b/src/api/clipcopy.zig
index 91cd089..6db30b8 100644
--- a/src/api/clipcopy.zig
+++ b/src/api/clipcopy.zig
@@ -1,7 +1,7 @@
 const Mepo = @import("../Mepo.zig");
 const types = @import("../types.zig");
 const std = @import("std");
-const sdl = @import("../sdlshim.zig");
+const sdl = types.sdl;
 const utildbg = @import("../util/utildbg.zig");
 const utilsdl = @import("../util/utilsdl.zig");
 const p = @import("../util/utilprefs.zig");
diff --git a/src/api/clippaste.zig b/src/api/clippaste.zig
index 8c45daf..3213f30 100644
--- a/src/api/clippaste.zig
+++ b/src/api/clippaste.zig
@@ -1,7 +1,7 @@
 const Mepo = @import("../Mepo.zig");
 const types = @import("../types.zig");
 const std = @import("std");
-const sdl = @import("../sdlshim.zig");
+const sdl = types.sdl;
 const utildbg = @import("../util/utildbg.zig");
 const utilsdl = @import("../util/utilsdl.zig");
 const p = @import("../util/utilprefs.zig");
diff --git a/src/api/filedump.zig b/src/api/filedump.zig
index 91191c9..fe60764 100644
--- a/src/api/filedump.zig
+++ b/src/api/filedump.zig
@@ -1,7 +1,7 @@
 const Mepo = @import("../Mepo.zig");
 const types = @import("../types.zig");
 const std = @import("std");
-const sdl = @import("../sdlshim.zig");
+const sdl = types.sdl;
 
 const utilfile = @import("../util/utilfile.zig");
 const utilsdl = @import("../util/utilsdl.zig");
diff --git a/src/api/shellpipe_async.zig b/src/api/shellpipe_async.zig
index 5291c82..4599545 100644
--- a/src/api/shellpipe_async.zig
+++ b/src/api/shellpipe_async.zig
@@ -7,7 +7,7 @@ const utilprocess = @import("../util/utilprocess.zig");
 const utildbg = @import("../util/utildbg.zig");
 const utilsdl = @import("../util/utilsdl.zig");
 const p = @import("../util/utilprefs.zig");
-const sdl = @import("../sdlshim.zig");
+const sdl = types.sdl;
 
 const AsyncShellpipeRequest = struct {
     mepo: *Mepo,
diff --git a/src/api/shellpipe_sync.zig b/src/api/shellpipe_sync.zig
index 0c20784..c2706b3 100644
--- a/src/api/shellpipe_sync.zig
+++ b/src/api/shellpipe_sync.zig
@@ -3,7 +3,7 @@ const types = @import("../types.zig");
 const std = @import("std");
 const utildbg = @import("../util/utildbg.zig");
 const blitfns = @import("../blit/blit.zig");
-const sdl = @import("../sdlshim.zig");
+const sdl = types.sdl;
 const filedump = @import("./filedump.zig");
 const run_shellpipe = @import("shellpipe_async.zig").run_shellpipe;
 
diff --git a/src/blit/blit.zig b/src/blit/blit.zig
index 63a6961..32c1386 100644
--- a/src/blit/blit.zig
+++ b/src/blit/blit.zig
@@ -1,6 +1,6 @@
 const Mepo = @import("../Mepo.zig");
 const std = @import("std");
-const sdl = @import("../sdlshim.zig");
+const sdl = types.sdl;
 const types = @import("../types.zig");
 const config = @import("../config.zig");
 const errors = @import("../errors.zig");
diff --git a/src/main.zig b/src/main.zig
index 7233abc..f1a2f3c 100644
--- a/src/main.zig
+++ b/src/main.zig
@@ -5,8 +5,8 @@ const Mepo = @import("./Mepo.zig");
 const Docs = @import("./Docs.zig");
 const Downloader = @import("./Downloader.zig");
 const TileCache = @import("./TileCache.zig");
-const sdl = @import("./sdlshim.zig");
 const types = @import("./types.zig");
+const sdl = types.sdl;
 const utildbg = @import("./util/utildbg.zig");
 
 pub fn main() !void {
diff --git a/src/sdlshim.zig b/src/sdlshim.zig
deleted file mode 100644
index 49fa303..0000000
--- a/src/sdlshim.zig
+++ /dev/null
@@ -1,7 +0,0 @@
-pub usingnamespace @cImport({
-    @cInclude("SDL2/SDL.h");
-    @cInclude("SDL2/SDL_revision.h");
-    @cInclude("SDL2/SDL_image.h");
-    @cInclude("SDL2/SDL2_gfxPrimitives.h");
-    @cInclude("SDL2/SDL_ttf.h");
-});
diff --git a/src/types.zig b/src/types.zig
index aa01170..df0da7a 100644
--- a/src/types.zig
+++ b/src/types.zig
@@ -1,6 +1,12 @@
 const std = @import("std");
 const Mepo = @import("Mepo.zig");
-const sdl = @import("./sdlshim.zig");
+pub const sdl = @cImport({
+    @cInclude("SDL2/SDL.h");
+    @cInclude("SDL2/SDL_revision.h");
+    @cInclude("SDL2/SDL_image.h");
+    @cInclude("SDL2/SDL2_gfxPrimitives.h");
+    @cInclude("SDL2/SDL_ttf.h");
+});
 
 pub const Latlon = struct { lat: f64, lon: f64 };
 pub const XYZ = struct { x: u32, y: u32, z: u8 };
diff --git a/src/util/utilplatform.zig b/src/util/utilplatform.zig
index 65d0dcc..0dd7269 100644
--- a/src/util/utilplatform.zig
+++ b/src/util/utilplatform.zig
@@ -1,4 +1,4 @@
-const sdl = @import("../sdlshim.zig");
+const sdl = @import("../types.zig").sdl;
 const std = @import("std");
 
 pub fn supports_osk() bool {
diff --git a/src/util/utilsdl.zig b/src/util/utilsdl.zig
index 47bf2e9..6ccf640 100644
--- a/src/util/utilsdl.zig
+++ b/src/util/utilsdl.zig
@@ -1,5 +1,5 @@
-const sdl = @import("../sdlshim.zig");
 const types = @import("../types.zig");
+const sdl = types.sdl;
 const errors = @import("../errors.zig");
 const utildbg = @import("./utildbg.zig");
 const RectOpt = enum { Draw, Fill };
